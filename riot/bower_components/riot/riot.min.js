/* Riot v2.2.3, @license MIT, (c) 2015 Muut Inc. + contributors */
(function(e,t){"use strict";var n={version:"v2.2.3",settings:{}},i=0;var r="string",o="object",u="undefined",f="function",a=["update","root","mount","unmount","mixin","isMounted","isLoop","tags","parent","opts","trigger","on","off","one"];var s=Array.isArray||function(){var e=Object.prototype.toString;return function(t){return e.call(t)==="[object Array]"}}();var c=function(t){return(e&&e.document||{}).documentMode|0}();n.observable=function(e){e=e||{};var t={},n=0;e.on=function(i,r){if(_(r)){if(typeof r.id===u)r._id=n++;i.replace(/\S+/g,function(e,n){(t[e]=t[e]||[]).push(r);r.typed=n>0})}return e};e.off=function(n,i){if(n=="*")t={};else{n.replace(/\S+/g,function(e){if(i){var n=t[e];for(var r=0,o;o=n&&n[r];++r){if(o._id==i._id)n.splice(r--,1)}}else{t[e]=[]}})}return e};e.one=function(t,n){function i(){e.off(t,i);n.apply(e,arguments)}return e.on(t,i)};e.trigger=function(n){var i=[].slice.call(arguments,1),r=t[n]||[];for(var o=0,u;u=r[o];++o){if(!u.busy){u.busy=1;u.apply(e,u.typed?[n].concat(i):i);if(r[o]!==u){o--}u.busy=0}}if(t.all&&n!="all"){e.trigger.apply(e,["all",n].concat(i))}return e};return e};n.mixin=function(){var e={};return function(t,n){if(!n)return e[t];e[t]=n}}();(function(e,t,n){if(!n)return;var i=n.location,r=e.observable(),o=false,u;function f(){return i.href.split("#")[1]||""}function a(e){return e.split("/")}function s(e){if(e.type)e=f();if(e!=u){r.trigger.apply(null,["H"].concat(a(e)));u=e}}var c=e.route=function(e){if(e[0]){i.hash=e;s(e)}else{r.on("H",e)}};c.exec=function(e){e.apply(null,a(f()))};c.parser=function(e){a=e};c.stop=function(){if(!o)return;n.removeEventListener?n.removeEventListener(t,s,false):n.detachEvent("on"+t,s);r.off("*");o=false};c.start=function(){if(o)return;n.addEventListener?n.addEventListener(t,s,false):n.attachEvent("on"+t,s);o=true};c.start()})(n,"hashchange",e);var l=function(e){var t,i,r,o=/[{}]/g;return function(u){var f=n.settings.brackets||e;if(t!==f){t=f;r=f.split(" ");i=r.map(function(e){return e.replace(/(?=.)/g,"\\")})}return u instanceof RegExp?f===e?u:new RegExp(u.source.replace(o,function(e){return i[~~(e==="}")]}),u.global?"g":""):r[u]}}("{ }");var p=function(){var t={},n=/(['"\/]).*?[^\\]\1|\.\w*|\w*:|\b(?:(?:new|typeof|in|instanceof) |(?:this|true|false|null|undefined)\b|function *\()|([a-z_$]\w*)/gi;return function(e,n){return e&&(t[e]=t[e]||i(e))(n)};function i(e,t){e=(e||l(0)+l(1)).replace(l(/\\{/g),"￰").replace(l(/\\}/g),"￱");t=u(e,f(e,l(/{/),l(/}/)));return new Function("d","return "+(!t[0]&&!t[2]&&!t[3]?r(t[1]):"["+t.map(function(e,t){return t%2?r(e,true):'"'+e.replace(/\n/g,"\\n").replace(/"/g,'\\"')+'"'}).join(",")+'].join("")').replace(/\uFFF0/g,l(0)).replace(/\uFFF1/g,l(1))+";")}function r(e,t){e=e.replace(/\n/g," ").replace(l(/^[{ ]+|[ }]+$|\/\*.+?\*\//g),"");return/^\s*[\w- "']+ *:/.test(e)?"["+f(e,/["' ]*[\w- ]+["' ]*:/,/,(?=["' ]*[\w- ]+["' ]*:)|}|$/).map(function(e){return e.replace(/^[ "']*(.+?)[ "']*: *(.+?),? *$/,function(e,t,n){return n.replace(/[^&|=!><]+/g,o)+'?"'+t+'":"",'})}).join("")+'].join(" ").trim()':o(e,t)}function o(t,i){t=t.trim();return!t?"":"(function(v){try{v="+(t.replace(n,function(t,n,i){return i?"(d."+i+"===undefined?"+(typeof e=="undefined"?"global.":"window.")+i+":d."+i+")":t})||"x")+"}catch(e){"+"}finally{return "+(i===true?'!v&&v!==0?"":v':"v")+"}}).call(d)"}function u(e,t){var n=[];t.map(function(t,i){i=e.indexOf(t);n.push(e.slice(0,i),t);e=e.slice(i+t.length)});return n.concat(e)}function f(e,t,n){var i,r=0,o=[],u=new RegExp("("+t.source+")|("+n.source+")","g");e.replace(u,function(t,n,u,f){if(!r&&n)i=f;r+=n?1:-1;if(!r&&u!=null)o.push(e.slice(i,f+u.length))});return o}}();function d(e){var t=l(0),n=e.trim().slice(t.length).match(/^\s*(\S+?)\s*(?:,\s*(\S+))?\s+in\s+(.+)$/);return n?{key:n[1],pos:n[2],val:t+n[3]}:{val:e}}function g(e,t,n){var i={};i[e.key]=t;if(e.pos)i[e.pos]=n;return i}function v(e,t,n){x(e,"each");var i=N(e),r=e.outerHTML,o=!!J[i],u=J[i]||{tmpl:r},f=e.parentNode,a=document.createComment("riot placeholder"),c=[],l=T(e),v;f.insertBefore(a,e);n=d(n);t.one("premount",function(){if(f.stub)f=t.root;e.parentNode.removeChild(e)}).on("update",function(){var r=p(n.val,t);if(!s(r)){v=r?JSON.stringify(r):"";r=!r?[]:Object.keys(r).map(function(e){return g(n,e,r[e])})}var d=document.createDocumentFragment(),m=c.length,h=r.length;while(m>h){c[--m].unmount();c.splice(m,1)}for(m=0;m<h;++m){var y=!v&&!!n.key?g(n,r[m],m):r[m];if(!c[m]){(c[m]=new b(u,{parent:t,isLoop:true,hasImpl:o,root:o?e.cloneNode():f,item:y},e.innerHTML)).mount();d.appendChild(c[m].root)}else c[m].update(y);c[m]._item=y}f.insertBefore(d,a);if(l)t.tags[i]=c}).one("updated",function(){var e=Object.keys(t);E(f,function(n){if(n.nodeType==1&&!n.isLoop&&!n._looped){n._visited=false;n._looped=true;D(n,t,e)}})})}function m(e,t,n){E(e,function(e){if(e.nodeType==1){e.isLoop=e.isLoop||(e.parentNode&&e.parentNode.isLoop||e.getAttribute("each"))?1:0;var i=T(e);if(i&&!e.isLoop){var r=new b(i,{root:e,parent:t},e.innerHTML),o=N(e),u=M(t),f;r.parent=u;f=u.tags[o];if(f){if(!s(f))u.tags[o]=[f];u.tags[o].push(r)}else{u.tags[o]=r}e.innerHTML="";n.push(r)}if(!e.isLoop)D(e,t,[])}})}function h(e,t,n){function i(e,t,i){if(t.indexOf(l(0))>=0){var r={dom:e,expr:t};n.push(A(r,i))}}E(e,function(e){var n=e.nodeType;if(n==3&&e.parentNode.tagName!="STYLE")i(e,e.nodeValue);if(n!=1)return;var r=e.getAttribute("each");if(r){v(e,t,r);return false}C(e.attributes,function(t){var n=t.name,r=n.split("__")[1];i(e,t.value,{attr:r||n,bool:r});if(r){x(e,n);return false}});if(T(e))return false})}function b(e,f,a){var c=n.observable(this),d=R(f.opts)||{},g=S(e.tmpl),v=f.parent,b=f.isLoop,y=f.hasImpl,w=H(f.item),x=[],T=[],N=f.root,E=e.fn,j=N.tagName.toLowerCase(),$={},B=[],D;if(E&&N._tag){N._tag.unmount(true)}this.isMounted=false;N.isLoop=b;N._tag=this;this._id=i++;A(this,{parent:v,root:N,opts:d,tags:{}},w);C(N.attributes,function(e){var t=e.value;if(l(/\{.*\}/).test(t))$[e.name]=t});if(g.innerHTML&&!/select|optgroup|tbody|tr/.test(j))g.innerHTML=F(g.innerHTML,a);function I(){var e=y&&b?c:v||c;C(N.attributes,function(t){d[t.name]=p(t.value,e)});C(Object.keys($),function(t){d[t]=H(p($[t],e))})}function V(e){for(var t in w){if(typeof c[t]!==u)c[t]=e[t]}}function q(){if(!c.parent||!b)return;C(Object.keys(c.parent),function(e){var t=~B.indexOf(e);if(typeof c[e]===u||t){if(!t)B.push(e);c[e]=c.parent[e]}})}this.update=function(e){e=H(e);q();if(typeof w===o){V(e||{});w=e}A(c,e);I();c.trigger("update",e);L(x,c);c.trigger("updated")};this.mixin=function(){C(arguments,function(e){e=typeof e===r?n.mixin(e):e;C(Object.keys(e),function(t){if(t!="init")c[t]=_(e[t])?e[t].bind(c):e[t]});if(e.init)e.init.bind(c)()})};this.mount=function(){I();E&&E.call(c,d);h(g,c,x);z(true);if(e.attrs){O(e.attrs,function(e,t){N.setAttribute(e,t)});h(c.root,c,x)}if(!c.parent||b)c.update(w);c.trigger("premount");if(b&&!y){c.root=N=D=g.firstChild}else{while(g.firstChild)N.appendChild(g.firstChild);if(N.stub)c.root=N=v.root}if(!c.parent||c.parent.isMounted){c.isMounted=true;c.trigger("mount")}else c.parent.one("mount",function(){if(!k(c.root)){c.parent.isMounted=c.isMounted=true;c.trigger("mount")}})};this.unmount=function(e){var n=D||N,i=n.parentNode,r;if(i){if(v){r=M(v);if(s(r.tags[j]))C(r.tags[j],function(e,t){if(e._id==c._id)r.tags[j].splice(t,1)});else r.tags[j]=t}else while(n.firstChild)n.removeChild(n.firstChild);if(!e)i.removeChild(n)}c.trigger("unmount");z();c.off("*");N._tag=null};function z(e){C(T,function(t){t[e?"mount":"unmount"]()});if(v){var t=e?"on":"off";if(b)v[t]("unmount",c.unmount);else v[t]("update",c.update)[t]("unmount",c.unmount)}}m(g,this,T)}function y(t,n,i,r){i[t]=function(t){var o=r._item,u=r.parent,f;if(!o)while(u){o=u._item;u=o?false:u.parent}t=t||e.event;try{t.currentTarget=i;if(!t.target)t.target=t.srcElement;if(!t.which)t.which=t.charCode||t.keyCode}catch(a){""}t.item=o;if(n.call(r,t)!==true&&!/radio|check/.test(i.type)){t.preventDefault&&t.preventDefault();t.returnValue=false}if(!t.preventUpdate){f=o?M(u):r;f.update()}}}function w(e,t,n){if(e){e.insertBefore(n,t);e.removeChild(t)}}function L(e,t){C(e,function(e,n){var i=e.dom,r=e.attr,u=p(e.expr,t),f=e.dom.parentNode;if(u==null)u="";if(f&&f.tagName=="TEXTAREA")u=u.replace(/riot-/g,"");if(e.value===u)return;e.value=u;if(!r)return i.nodeValue=u.toString();x(i,r);if(_(u)){y(r,u,i,t)}else if(r=="if"){var a=e.stub;if(u){if(a){w(a.parentNode,a,i);i.inStub=false;if(!k(i)){E(i,function(e){if(e._tag&&!e._tag.isMounted)e._tag.isMounted=!!e._tag.trigger("mount")})}}}else{a=e.stub=a||document.createTextNode("");w(i.parentNode,i,a);i.inStub=true}}else if(/^(show|hide)$/.test(r)){if(r=="hide")u=!u;i.style.display=u?"":"none"}else if(r=="value"){i.value=u}else if(r.slice(0,5)=="riot-"&&r!="riot-tag"){r=r.slice(5);u?i.setAttribute(r,u):x(i,r)}else{if(e.bool){i[r]=u;if(!u)return;u=r}if(typeof u!==o)i.setAttribute(r,u)}})}function C(e,t){for(var n=0,i=(e||[]).length,r;n<i;n++){r=e[n];if(r!=null&&t(r,n)===false)n--}return e}function _(e){return typeof e===f||false}function x(e,t){e.removeAttribute(t)}function T(e){return J[e.getAttribute(U)||e.tagName.toLowerCase()]}function M(e){var t=e;while(!T(t.root)){if(!t.parent)break;t=t.parent}return t}function N(e){var t=T(e),n=e.getAttribute("name"),i=n&&n.indexOf(l(0))<0?n:t?t.name:e.tagName.toLowerCase();return i}function A(e){var t,n=arguments;for(var i=1;i<n.length;++i){if(t=n[i]){for(var r in t){e[r]=t[r]}}}return e}function H(e){if(!(e instanceof b)&&!(e&&typeof e.trigger==f))return e;var t={};for(var n in e){if(!~a.indexOf(n))t[n]=e[n]}return t}function S(e){var t=c&&c<10,n=/^\s*<([\w-]+)/.exec(e),i=n?n[1].toLowerCase():"",r=i==="th"||i==="td"?"tr":i==="tr"?"tbody":"div",o=j(r);o.stub=true;if(t){if(i==="optgroup")q(o,e);else if(i==="option")V(o,e);else if(r!=="div")I(o,e,i);else t=0}if(!t)o.innerHTML=e;return o}function E(e,t){if(e){if(t(e)===false)E(e.nextSibling,t);else{e=e.firstChild;while(e){E(e,t);e=e.nextSibling}}}}function O(e,t){var n,i=/([-\w]+) ?= ?(?:"([^"]*)|'([^']*)|({[^}]*}))/g;while(n=i.exec(e)){t(n[1].toLowerCase(),n[2]||n[3]||n[4])}}function k(e){while(e){if(e.inStub)return true;e=e.parentNode}return false}function j(e){return document.createElement(e)}function F(e,t){return e.replace(/<(yield)\/?>(<\/\1>)?/gim,t||"")}function $(e,t){return(t||document).querySelectorAll(e)}function B(e,t){return(t||document).querySelector(e)}function R(e){function t(){}t.prototype=e;return new t}function D(e,t,n){if(e._visited)return;var i,r=e.getAttribute("id")||e.getAttribute("name");if(r){if(n.indexOf(r)<0){i=t[r];if(!i)t[r]=e;else s(i)?i.push(e):t[r]=[i,e]}e._visited=true}}function I(e,t,n){var i=j("div"),r=/td|th/.test(n)?3:2,o;i.innerHTML="<table>"+t+"</table>";o=i.firstChild;while(r--)o=o.firstChild;e.appendChild(o)}function V(e,t){var n=j("option"),i=/value=[\"'](.+?)[\"']/,r=/selected=[\"'](.+?)[\"']/,o=/each=[\"'](.+?)[\"']/,u=/if=[\"'](.+?)[\"']/,f=/>([^<]*)</,a=t.match(i),s=t.match(r),c=t.match(f),l=t.match(o),p=t.match(u);if(c)n.innerHTML=c[1];else n.innerHTML=t;if(a)n.value=a[1];if(s)n.setAttribute("riot-selected",s[1]);if(l)n.setAttribute("each",l[1]);if(p)n.setAttribute("if",p[1]);e.appendChild(n)}function q(e,t){var n=j("optgroup"),i=/label=[\"'](.+?)[\"']/,r=/^<([^>]*)>/,o=/^<([^ \>]*)/,u=t.match(i),f=t.match(r),a=t.match(o),s=t;if(f){var c=t.slice(f[1].length+2,-a[1].length-3).trim();s=c}if(u)n.setAttribute("riot-label",u[1]);if(s){var l=j("div");V(l,s);n.appendChild(l.firstChild)}e.appendChild(n)}var z=[],J={},P;var U="riot-tag";function W(e){if(n.render)return;if(!P){P=j("style");P.setAttribute("type","text/css")}var t=document.head||document.getElementsByTagName("head")[0];if(P.styleSheet)P.styleSheet.cssText+=e;else P.innerHTML+=e;if(!P._rendered)if(P.styleSheet){document.body.appendChild(P)}else{var i=B("style[type=riot]");if(i){i.parentNode.insertBefore(P,i);i.parentNode.removeChild(i)}else t.appendChild(P)}P._rendered=true}function X(e,t,n){var i=J[t],r=e._innerHTML=e._innerHTML||e.innerHTML;e.innerHTML="";if(i&&e)i=new b(i,{root:e,opts:n},r);if(i&&i.mount){i.mount();z.push(i);return i.on("unmount",function(){z.splice(z.indexOf(i),1)})}}n.tag=function(e,t,n,i,r){if(_(i)){r=i;if(/^[\w\-]+\s?=/.test(n)){i=n;n=""}else i=""}if(n){if(_(n))r=n;else W(n)}J[e]={name:e,tmpl:t,attrs:i,fn:r};return e};n.mount=function(e,t,n){var i,u,f=[];function a(e){var t="";C(e,function(e){t+=', *[riot-tag="'+e.trim()+'"]'});return t}function s(){var e=Object.keys(J);return e+a(e)}function c(e){var i;if(e.tagName){if(t&&(!(i=e.getAttribute(U))||i!=t))e.setAttribute(U,t);var r=X(e,t||e.getAttribute(U)||e.tagName.toLowerCase(),n);if(r)f.push(r)}else if(e.length){C(e,c)}}if(typeof t===o){n=t;t=0}if(typeof e===r){if(e==="*")e=u=s();else e+=a(e.split(","));i=$(e)}else i=e;if(t==="*"){t=u||s();if(i.tagName)i=$(t,i);else{var l=[];C(i,function(e){l.push($(t,e))});i=l}t=0}if(i.tagName)c(i);else C(i,c);return f};n.update=function(){return C(z,function(e){e.update()})};n.mountTo=n.mount;n.util={brackets:l,tmpl:p};if(typeof exports===o)module.exports=n;else if(typeof define==="function"&&define.amd)define(function(){return e.riot=n});else e.riot=n})(typeof window!="undefined"?window:void 0);
